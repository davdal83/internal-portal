<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- Styles -->
  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/login.css" />

  <!-- Supabase library & config -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/supabase.js" defer></script>

  <!-- Login logic -->
  <script>
    async function smartAutoLogin() {
      const messageDiv = document.getElementById("login-message");
      try {
        const { data, error } = await supabaseClient.auth.getSession();
        if (error) {
          console.warn("Session check error:", error.message);
          return; // show form as normal
        }
  
        if (data?.session) {
          messageDiv.textContent = "Already logged in... Redirecting";
          setTimeout(() => {
            window.location.href = "dashboard.html";
          }, 1000); // short delay to show message
        }
      } catch (err) {
        console.warn("Auto-login failed:", err);
      }
    }
  
    smartAutoLogin();
  </script>

</head>
<body class="login-page">
  <div class="login-container">
    <h1>Internal Portal Login</h1>
    <form id="login-form">
      <label for="email">Email</label>
      <input type="email" id="email" placeholder="you@example.com" required autocomplete="username" />
      <label for="password">Password</label>
      <input type="password" id="password" placeholder="Your password" required autocomplete="current-password" />
      <button type="submit">Log In</button>
      <div id="login-message"></div>
    </form>
  </div>
</body>
</html>
